{"version":3,"sources":["webpack://imsdk/webpack/universalModuleDefinition","webpack://imsdk/webpack/bootstrap","webpack://imsdk/./src/lim/log/Logger.ts","webpack://imsdk/./src/lim/common/utils.ts","webpack://imsdk/./src/lim/core/ImClient.ts","webpack://imsdk/./src/lim/common/Fetch.ts","webpack://imsdk/./src/lim.ts","webpack://imsdk/./src/lim/codec/ByteBuffer.ts","webpack://imsdk/./src/lim/pack/LoginPack.ts","webpack://imsdk/./src/lim/common/WebToolkit.ts","webpack://imsdk/(webpack)/buildin/global.js","webpack://imsdk/./src/lim/uniapp/http/uni-fetch.js","webpack://imsdk/./node_modules/websocket/lib/browser.js","webpack://imsdk/./node_modules/es5-ext/global.js","webpack://imsdk/./node_modules/websocket/lib/version.js","webpack://imsdk/./src/lim/model/RequestBase.ts","webpack://imsdk/./src/lim/model/RequestParams.ts","webpack://imsdk/./src/lim/core/HttpApi.ts","webpack://imsdk/./src/lim/model/ApiResponse.ts","webpack://imsdk/./src/lim/common/Command.ts","webpack://imsdk/./src/lim/pack/MessagePack.ts"],"names":["root","factory","exports","module","define","amd","window","installedModules","__webpack_require__","moduleId","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","__spreadArrays","this","il","arguments","length","Array","k","a","j","jl","Logger","info","message","optionalParams","_i","debug","console","apply","Date","toISOString","infoTag","tag","error","errorTag","trace","e","Error","undefined","stack","Beans","to","target","JSON","parse","stringify","bean","json","copy","replace","replaceJSON","v","toMapByKey","arrs","result","forEach","strEmpty","strNotEmpty","isEmpty","str","uuid","Math","random","toString","slice","getTime","__awaiter","thisArg","_arguments","P","generator","Promise","resolve","reject","fulfilled","step","next","rejected","done","then","__generator","body","f","y","g","_","label","sent","trys","ops","verb","iterator","op","TypeError","pop","push","imClient","getLen","limLogin","ImClient","sleep","State","TimeUnit","Logger_1","ByteBuffer_1","LoginPack_1","WebToolkit_1","websocket_1","RequestBase_1","RequestParams_1","HttpApi_1","utils_1","Command_1","MessagePack_1","firstMonitorSocket","second","Unit","Second","_a","setTimeout","url","version","clientType","listeners","state","INIT","httpUrl","getRequestBase","RequestBase","appId","imei","isInit","CONNECTED","getRequestParams","RequestParams","userId","userSign","init","callback","self","resp","ip","port","req","success","err","conn","_this","_b","getDeviceInfo","system","imeiLength","isFailed","data","LoginPack","onerror","onSocketErrorEvent","errorHandler","onclose","CLOSEING","onSocketCloseEvent","reason","onmessage","evt","bytebuf","byteBuffer","int32","unpack","command","bodyLen","msgBody","vstring","log","MessageCommand","MSG_P2P","onP2PMessage","onTestMessage","heartbeatLoop","onLogin","buildMessagePack","messagePack","jsonData","pack","index","error_1","CLOSED","RECONNECTING","onSocketReConnectEvent","onSocketReConnectSuccessEvent","getSingleUserInfo","uid","syncGetUserInfo","api","userIds","getUserInfo","getAllFriend","fromId","start","now","loop","pingPack","SystemCommand","PING","send","createP2PTextMessage","text","MessagePack","buildTextMessagePack","sendP2PMessage","p2pPack","getUserId","w3cwebsocket","binaryType","tr","clearTimeout","onopen","readyState","OPEN","onSocketConnectEvent","loginPack","len","charCodeAt","Fetch","getFetchToolkit","httpFetch","global","fetch","im","ImClient_1","uni","ByteBuffer","arrayBuf","offset","Type_Byte","Type_Short","Type_UShort","Type_Int32","Type_UInt32","Type_String","Type_VString","Type_Int64","Type_Float","Type_Double","Type_ByteArray","_offset","_list","_littleEndian","_org_buf","constructor","DataView","Uint8Array","buffer","bigEndian","littleEndianfunction","utf8Write","view","setUint8","val","getInt32","splice","uint32","getUint32","blength","string","utf8Read","utf8Length","chr","end","byte","getUint8","String","fromCharCode","vlen","int64","getFloat64","float","getFloat32","double","byteArray","arr","packWithHead","ifHead","ArrayBuffer","setUint32","setInt8","setInt16","setUint16","setInt32","setFloat64","setFloat32","indx","getAvailable","byteLength","Fetch_1","Base64","_keyStr","encode","u","_utf8_encode","isNaN","charAt","decode","indexOf","_utf8_decode","c2","c3","WebToolkit","getBrowserInfo","agent","navigator","userAgent","toLowerCase","REGSTR_EDGE","REGSTR_IE","OLD_IE","REGSTR_FF","REGSTR_CHROME","REGSTR_SAF","REGSTR_OPERA","code","split","browser","browserVersion","match","getWxappInfo","getReactNativeInfo","getUniAppInfo","loadJS","script","document","createElement","fn","type","exist","getElementsByTagName","children","dom","outerHTML","onreadystatechange","onload","src","appendChild","getIpInfoByFetch","request","method","headers","response","res","currentCity","eval","getIpInfoByInsertScript","getIpInfo","base64Encode","base64Decode","Function","globalThis","support","Blob","viewClasses","isArrayBufferView","isView","obj","normalizeName","test","normalizeValue","iteratorFor","items","shift","Headers","map","append","isArray","header","getOwnPropertyNames","consumed","bodyUsed","fileReaderReady","reader","readBlobAsArrayBuffer","blob","FileReader","promise","readAsArrayBuffer","bufferClone","buf","set","Body","_initBody","_bodyInit","_bodyText","isPrototypeOf","_bodyBlob","FormData","_bodyFormData","URLSearchParams","_bodyArrayBuffer","arrayBuffer","isConsumed","byteOffset","readAsText","chars","join","readArrayBufferAsText","formData","oldValue","has","keys","values","entries","methods","Request","input","options","upcased","credentials","signal","toUpperCase","referrer","cache","reParamSearch","form","trim","bytes","decodeURIComponent","parseUniappHeaders","rawHeaders","Response","bodyInit","status","ok","statusText","clone","redirectStatuses","redirect","RangeError","location","DOMException","aborted","toStr","rawBody","requestTask","href","fixUrl","complete","removeEventListener","abortXhr","errMsg","statusCode","abort","addEventListener","polyfill","_globalThis","NativeWebSocket","WebSocket","MozWebSocket","websocket_version","W3CWebSocket","uri","protocols","prop","naiveFallback","configurable","__global__","identifier","ApiResponse_1","HttpApi","params","reqUrl","paramStr","setQueryConfig","_str","substring","rnfetch1","response2ApiResponse","apiResponse","msg","ApiResponse","succeed","isSucceed","FriendShipCommand","GroupCommand","UserEventCommand","ConversationEventCommand","messageId","messageRandom","RangeInteger","messageTime","min","max","range","floor","toId","content","messageBody","buildCustomerMessagePack"],"mappings":"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","file":"lim-sdk.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"imsdk\"] = factory();\n\telse\n\t\troot[\"imsdk\"] = factory();\n})(window, function() {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 4);\n","\"use strict\";\r\nvar __spreadArrays = (this && this.__spreadArrays) || function () {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n};\r\nexports.__esModule = true;\r\nvar Logger = /** @class */ (function () {\r\n    function Logger() {\r\n    }\r\n    Logger.info = function (message) {\r\n        var optionalParams = [];\r\n        for (var _i = 1; _i < arguments.length; _i++) {\r\n            optionalParams[_i - 1] = arguments[_i];\r\n        }\r\n        if (Logger.debug) {\r\n            console.info.apply(console, __spreadArrays([new Date().toISOString() + \" : \" + message], optionalParams));\r\n        }\r\n    };\r\n    Logger.infoTag = function (tag, message) {\r\n        var optionalParams = [];\r\n        for (var _i = 2; _i < arguments.length; _i++) {\r\n            optionalParams[_i - 2] = arguments[_i];\r\n        }\r\n        if (Logger.debug) {\r\n            console.info.apply(console, __spreadArrays([new Date().toISOString() + \" \" + tag + \" : \" + message], optionalParams));\r\n        }\r\n    };\r\n    Logger.error = function (message) {\r\n        var optionalParams = [];\r\n        for (var _i = 1; _i < arguments.length; _i++) {\r\n            optionalParams[_i - 1] = arguments[_i];\r\n        }\r\n        if (Logger.debug) {\r\n            console.error.apply(console, __spreadArrays([new Date().toISOString() + \" : \" + message], optionalParams));\r\n        }\r\n    };\r\n    Logger.errorTag = function (tag, message) {\r\n        var optionalParams = [];\r\n        for (var _i = 2; _i < arguments.length; _i++) {\r\n            optionalParams[_i - 2] = arguments[_i];\r\n        }\r\n        if (Logger.debug) {\r\n            console.error.apply(console, __spreadArrays([new Date().toISOString() + \" \" + tag + \"  : \" + message], optionalParams));\r\n        }\r\n    };\r\n    Logger.trace = function (e) {\r\n        if (Logger.debug) {\r\n            if (e instanceof Error) {\r\n                console.error(e.message + \" \\n \" + (e.stack !== undefined ? e.stack : ''));\r\n            }\r\n            else {\r\n                console.error(e);\r\n            }\r\n        }\r\n    };\r\n    Logger.debug = true;\r\n    return Logger;\r\n}());\r\nexports[\"default\"] = Logger;\r\n","\"use strict\";\r\nexports.__esModule = true;\r\nvar Beans = /** @class */ (function () {\r\n    function Beans() {\r\n    }\r\n    Beans.to = function (target) {\r\n        return JSON.parse(JSON.stringify(target));\r\n    };\r\n    Beans.bean = function (json) {\r\n        return JSON.parse(json);\r\n    };\r\n    Beans.copy = function (target) {\r\n        return Beans.to(target);\r\n    };\r\n    Beans.replace = function (target, replaceJSON) {\r\n        var r = Beans.to(target);\r\n        for (var v in replaceJSON) {\r\n            r[v] = replaceJSON[v];\r\n        }\r\n        return r;\r\n    };\r\n    Beans.toMapByKey = function (arrs, key) {\r\n        var result = {};\r\n        arrs.forEach(function (v) {\r\n            if (v.hasOwnProperty(key)) {\r\n                result[key] = v;\r\n            }\r\n        });\r\n        return result;\r\n    };\r\n    Beans.json = function (target) {\r\n        return JSON.stringify(target);\r\n    };\r\n    Beans.strEmpty = function (s) {\r\n        return !!s;\r\n    };\r\n    Beans.strNotEmpty = function (s) {\r\n        return !s;\r\n    };\r\n    Beans.isEmpty = function (str) {\r\n        if (str === null ||\r\n            str === '' ||\r\n            str === undefined ||\r\n            str.length === 0) {\r\n            return true;\r\n        }\r\n        else {\r\n            return false;\r\n        }\r\n    };\r\n    Beans.uuid = function () {\r\n        return (Math.random() * 36).toString(36).slice(2) + new Date().getTime().toString();\r\n    };\r\n    return Beans;\r\n}());\r\nexports[\"default\"] = Beans;\r\n","\"use strict\";\r\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nvar __generator = (this && this.__generator) || function (thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n};\r\nexports.__esModule = true;\r\nexports.imClient = exports.getLen = exports.limLogin = exports.ImClient = exports.sleep = exports.State = void 0;\r\nvar Logger_1 = require(\"../log/Logger\");\r\nvar ByteBuffer_1 = require(\"../codec/ByteBuffer\");\r\nvar LoginPack_1 = require(\"../pack/LoginPack\");\r\nvar WebToolkit_1 = require(\"../common/WebToolkit\");\r\nvar websocket_1 = require(\"websocket\");\r\nvar RequestBase_1 = require(\"../model/RequestBase\");\r\nvar RequestParams_1 = require(\"../model/RequestParams\");\r\nvar HttpApi_1 = require(\"./HttpApi\");\r\nvar utils_1 = require(\"../common/utils\");\r\nvar Command_1 = require(\"../common/Command\");\r\nvar MessagePack_1 = require(\"../pack/MessagePack\");\r\nvar loginTimeout = 10 * 1000; // 10 seconds\r\nvar heartbeatInterval = 10 * 1000; // seconds\r\nvar firstMonitorSocket = false; // 第一次监听socket\r\nvar State;\r\n(function (State) {\r\n    State[State[\"INIT\"] = 0] = \"INIT\";\r\n    State[State[\"CONNECTING\"] = 1] = \"CONNECTING\";\r\n    State[State[\"CONNECTED\"] = 2] = \"CONNECTED\";\r\n    State[State[\"RECONNECTING\"] = 3] = \"RECONNECTING\";\r\n    State[State[\"CLOSEING\"] = 4] = \"CLOSEING\";\r\n    State[State[\"CLOSED\"] = 5] = \"CLOSED\";\r\n})(State = exports.State || (exports.State = {}));\r\nvar TimeUnit;\r\n(function (TimeUnit) {\r\n    TimeUnit[TimeUnit[\"Second\"] = 1000] = \"Second\";\r\n    TimeUnit[TimeUnit[\"Millisecond\"] = 1] = \"Millisecond\";\r\n})(TimeUnit || (TimeUnit = {}));\r\nexports.sleep = function (second, Unit) {\r\n    if (Unit === void 0) { Unit = TimeUnit.Second; }\r\n    return __awaiter(void 0, void 0, void 0, function () {\r\n        return __generator(this, function (_a) {\r\n            return [2 /*return*/, new Promise(function (resolve, _) {\r\n                    setTimeout(function () {\r\n                        resolve();\r\n                    }, second * Unit);\r\n                })];\r\n        });\r\n    });\r\n};\r\nvar ImClient = /** @class */ (function () {\r\n    function ImClient() {\r\n        this.url = \"\";\r\n        this.version = 1;\r\n        this.clientType = 1;\r\n        this.listeners = null;\r\n        this.state = State.INIT;\r\n        // lastOfflineMessageSequence: number = 0;\r\n        // offlineMessageList: Array<any> = new Array<any>()\r\n        this.httpUrl = \"http://127.0.0.1:8000/v1\";\r\n    }\r\n    ImClient.prototype.getRequestBase = function () {\r\n        return new RequestBase_1.RequestBase(this.appId, this.clientType, this.imei);\r\n    };\r\n    ImClient.prototype.isInit = function () {\r\n        return this.state == State.CONNECTED;\r\n    };\r\n    ImClient.prototype.getRequestParams = function () {\r\n        return new RequestParams_1.RequestParams(this.appId, this.userId, this.userSign);\r\n    };\r\n    ImClient.prototype.init = function (appId, userId, userSign, listeners, callback) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var self, api, resp, ip, port, req, _a, success, err, conn;\r\n            var _this = this;\r\n            return __generator(this, function (_b) {\r\n                switch (_b.label) {\r\n                    case 0:\r\n                        self = this;\r\n                        // self.httpUrl = httpUrl\r\n                        self.appId = appId;\r\n                        self.listeners = listeners;\r\n                        self.imei = WebToolkit_1[\"default\"].getDeviceInfo().system;\r\n                        self.imeiLength = exports.getLen(self.imei);\r\n                        self.userId = userId;\r\n                        this.userSign = userSign;\r\n                        this.imeiLength = self.imeiLength;\r\n                        if (!utils_1[\"default\"].isEmpty(this.url)) return [3 /*break*/, 2];\r\n                        Logger_1[\"default\"].info(\"获取im地址\");\r\n                        api = new HttpApi_1[\"default\"]();\r\n                        return [4 /*yield*/, api.call(\"/user/login\", {}, { clientType: this.clientType, appId: this.appId, userId: this.userId })\r\n                            // console.log(resp)\r\n                        ];\r\n                    case 1:\r\n                        resp = _b.sent();\r\n                        // console.log(resp)\r\n                        if (resp.isFailed()) {\r\n                            Logger_1[\"default\"].info(\"登录失败：获取im地址失败\");\r\n                            return [2 /*return*/];\r\n                        }\r\n                        ip = resp.data.ip;\r\n                        port = resp.data.port;\r\n                        this.url = \"ws://\" + ip + \":\" + port + \"/ws\";\r\n                        _b.label = 2;\r\n                    case 2:\r\n                        req = new LoginPack_1.LoginPack(self.appId, self.userId, 1);\r\n                        return [4 /*yield*/, exports.limLogin(self.url, req, self)];\r\n                    case 3:\r\n                        _a = _b.sent(), success = _a.success, err = _a.err, conn = _a.conn;\r\n                        if (success) {\r\n                            if (!firstMonitorSocket) {\r\n                                firstMonitorSocket = true;\r\n                            }\r\n                            //登录成功以后操作\r\n                            conn.onerror = function (error) {\r\n                                Logger_1[\"default\"].info(\"websocket error: \", error);\r\n                                // 加入socket 连接事件\r\n                                if (typeof exports.imClient.listeners.onSocketErrorEvent === 'function') {\r\n                                    exports.imClient.listeners.onSocketErrorEvent(error);\r\n                                }\r\n                                //异步方法，自动重连\r\n                                _this.errorHandler(error, req);\r\n                            };\r\n                            conn.onclose = function (e) {\r\n                                Logger_1[\"default\"].info(\"event[onclose] fired\");\r\n                                if (self.state == State.CLOSEING) {\r\n                                    _this.onclose(\"logout\");\r\n                                    return;\r\n                                }\r\n                                // socket断开事件 连接事件\r\n                                if (typeof exports.imClient.listeners.onSocketCloseEvent === 'function') {\r\n                                    exports.imClient.listeners.onSocketCloseEvent();\r\n                                }\r\n                                // 异步方法 自动重连\r\n                                _this.errorHandler(new Error(e.reason), req);\r\n                            };\r\n                            conn.onmessage = function (evt) {\r\n                                var bytebuf = new ByteBuffer_1[\"default\"](evt.data);\r\n                                var byteBuffer = bytebuf.int32().int32().unpack();\r\n                                var command = byteBuffer[0]; //解析command\r\n                                var bodyLen = byteBuffer[1]; //解析bodylen\r\n                                var unpack = bytebuf.vstring(null, bodyLen).unpack(); //解析出字符串\r\n                                var msgBody = unpack[2];\r\n                                console.log(\"sdk收到服务端数据：\" + msgBody);\r\n                                if (command === Command_1.MessageCommand.MSG_P2P) {\r\n                                    //单聊消息收发\r\n                                    if (typeof exports.imClient.listeners.onP2PMessage === 'function') {\r\n                                        exports.imClient.listeners.onP2PMessage(msgBody);\r\n                                    }\r\n                                }\r\n                                else {\r\n                                    if (typeof exports.imClient.listeners.onTestMessage === 'function') {\r\n                                        exports.imClient.listeners.onTestMessage(msgBody);\r\n                                    }\r\n                                }\r\n                            };\r\n                            this.conn = conn;\r\n                            this.state = State.CONNECTED;\r\n                            //拉取离线消息\r\n                            // this.loadOfflineMessage();\r\n                            //心跳包\r\n                            this.heartbeatLoop(this.conn);\r\n                            if (typeof exports.imClient.listeners.onLogin === 'function') {\r\n                                exports.imClient.listeners.onLogin(this.userId);\r\n                            }\r\n                            callback(self);\r\n                        }\r\n                        else {\r\n                            Logger_1[\"default\"].error(err === null || err === void 0 ? void 0 : err.message);\r\n                        }\r\n                        return [2 /*return*/];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    ImClient.prototype.buildMessagePack = function (command, messagePack) {\r\n        var jsonData = JSON.stringify(messagePack);\r\n        var bodyLen = exports.getLen(jsonData);\r\n        var pack = new ByteBuffer_1[\"default\"](null, 0);\r\n        pack.int32(command).int32(this.version).int32(this.clientType)\r\n            .int32(0x0)\r\n            .int32(this.appId)\r\n            .int32(this.imeiLength)\r\n            .int32(bodyLen)\r\n            .vstring(this.imei, this.imeiLength)\r\n            .vstring(jsonData, bodyLen);\r\n        return pack;\r\n    };\r\n    // 4. 自动重连\r\n    ImClient.prototype.errorHandler = function (error, req) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var index, _a, success, err, conn, error_1;\r\n            return __generator(this, function (_b) {\r\n                switch (_b.label) {\r\n                    case 0:\r\n                        // 如果是主动断开连接，就没有必要自动重连\r\n                        // 比如收到被踢，或者主动调用logout()方法\r\n                        if (this.state == State.CLOSED || this.state == State.CLOSEING) {\r\n                            return [2 /*return*/];\r\n                        }\r\n                        this.state = State.RECONNECTING;\r\n                        if (typeof exports.imClient.listeners.onSocketReConnectEvent === 'function') {\r\n                            exports.imClient.listeners.onSocketReConnectEvent();\r\n                        }\r\n                        index = 0;\r\n                        _b.label = 1;\r\n                    case 1:\r\n                        if (!(index < 10)) return [3 /*break*/, 7];\r\n                        return [4 /*yield*/, exports.sleep(3)];\r\n                    case 2:\r\n                        _b.sent();\r\n                        _b.label = 3;\r\n                    case 3:\r\n                        _b.trys.push([3, 5, , 6]);\r\n                        Logger_1[\"default\"].info(\"try to relogin\");\r\n                        return [4 /*yield*/, exports.limLogin(this.url, req, this)];\r\n                    case 4:\r\n                        _a = _b.sent(), success = _a.success, err = _a.err, conn = _a.conn;\r\n                        if (success) {\r\n                            if (typeof exports.imClient.listeners.onSocketReConnectSuccessEvent === 'function') {\r\n                                exports.imClient.listeners.onSocketReConnectSuccessEvent();\r\n                            }\r\n                            return [2 /*return*/];\r\n                        }\r\n                        Logger_1[\"default\"].info(err);\r\n                        return [3 /*break*/, 6];\r\n                    case 5:\r\n                        error_1 = _b.sent();\r\n                        Logger_1[\"default\"].info(error_1);\r\n                        return [3 /*break*/, 6];\r\n                    case 6:\r\n                        index++;\r\n                        return [3 /*break*/, 1];\r\n                    case 7:\r\n                        this.onclose(\"reconnect timeout\");\r\n                        return [2 /*return*/];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    // 表示连接中止\r\n    ImClient.prototype.onclose = function (reason) {\r\n        if (this.state == State.CLOSED) {\r\n            return;\r\n        }\r\n        this.state = State.CLOSED;\r\n        Logger_1[\"default\"].info(\"connection closed due to \" + reason);\r\n        this.conn = undefined;\r\n        this.userId = \"\";\r\n        // 加入socket 关闭事件\r\n        if (typeof exports.imClient.listeners.onSocketErrorEvent === 'function') {\r\n            exports.imClient.listeners.onSocketCloseEvent();\r\n        }\r\n    };\r\n    ImClient.prototype.getSingleUserInfo = function (uid) {\r\n        var _this = this;\r\n        return new Promise(function (resolve, _) {\r\n            var api = new HttpApi_1[\"default\"]();\r\n            var resp = api.call(\"/user/data/getSingleUserInfo\", _this.getRequestParams(), { userId: uid });\r\n            resolve(resp);\r\n        });\r\n    };\r\n    ImClient.prototype.syncGetUserInfo = function (userId) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var api, resp;\r\n            return __generator(this, function (_a) {\r\n                api = new HttpApi_1[\"default\"]();\r\n                resp = api.call(\"/user/data/getUserInfo\", this.getRequestParams(), { userIds: userId });\r\n                return [2 /*return*/, resp];\r\n            });\r\n        });\r\n    };\r\n    ImClient.prototype.getUserInfo = function (userId) {\r\n        var _this = this;\r\n        return new Promise(function (resolve, _) {\r\n            var api = new HttpApi_1[\"default\"]();\r\n            var resp = api.call(\"/user/data/getUserInfo\", _this.getRequestParams(), { userIds: userId });\r\n            resolve(resp);\r\n        });\r\n    };\r\n    ImClient.prototype.getAllFriend = function () {\r\n        var _this = this;\r\n        return new Promise(function (resolve, _) {\r\n            var api = new HttpApi_1[\"default\"]();\r\n            var resp = api.call(\"/friendship/getAllFriendShip\", _this.getRequestParams(), { fromId: _this.userId });\r\n            resolve(resp);\r\n        });\r\n    };\r\n    // 2、心跳\r\n    ImClient.prototype.heartbeatLoop = function (conn) {\r\n        var _this = this;\r\n        var start = Date.now();\r\n        var loop = function () {\r\n            if (_this.state != State.CONNECTED) {\r\n                Logger_1[\"default\"].error(\"heartbeatLoop exited\");\r\n                return;\r\n            }\r\n            if (Date.now() - start >= heartbeatInterval) {\r\n                Logger_1[\"default\"].info(\">>> send ping ;\");\r\n                start = Date.now();\r\n                var pingPack = exports.imClient.buildMessagePack(Command_1.SystemCommand.PING, {});\r\n                conn.send(pingPack.pack(false));\r\n            }\r\n            setTimeout(loop, 500);\r\n        };\r\n        setTimeout(loop, 500);\r\n    };\r\n    //构建单聊消息对象\r\n    ImClient.prototype.createP2PTextMessage = function (to, text) {\r\n        var messagePack = new MessagePack_1.MessagePack(this.appId);\r\n        messagePack.buildTextMessagePack(this.userId, to, text);\r\n        return messagePack;\r\n    };\r\n    ImClient.prototype.sendP2PMessage = function (pack) {\r\n        var p2pPack = exports.imClient.buildMessagePack(Command_1.MessageCommand.MSG_P2P, pack);\r\n        if (this.conn) {\r\n            this.conn.send(p2pPack.pack(false));\r\n        }\r\n    };\r\n    ImClient.prototype.getUserId = function () {\r\n        return this.userId;\r\n    };\r\n    return ImClient;\r\n}());\r\nexports.ImClient = ImClient;\r\nexports.limLogin = function (url, req, imClient) { return __awaiter(void 0, void 0, void 0, function () {\r\n    return __generator(this, function (_a) {\r\n        return [2 /*return*/, new Promise(function (resolve, _) {\r\n                var conn = new websocket_1.w3cwebsocket(url);\r\n                conn.binaryType = \"arraybuffer\";\r\n                Logger_1[\"default\"].info(\"limLogin\");\r\n                // 设置一个登陆超时器\r\n                var tr = setTimeout(function () {\r\n                    clearTimeout(tr);\r\n                    resolve({ success: false, err: new Error(\"timeout\"), conn: conn });\r\n                }, loginTimeout);\r\n                conn.onopen = function () {\r\n                    if (conn.readyState == websocket_1.w3cwebsocket.OPEN) {\r\n                        // 加入socket 连接事件\r\n                        if (typeof imClient.listeners.onSocketConnectEvent === 'function') {\r\n                            imClient.listeners.onSocketConnectEvent(url, req);\r\n                        }\r\n                        Logger_1[\"default\"].info(\"\\u5F00\\u542F\\u8FDE\\u63A5\");\r\n                        //登录数据包\r\n                        var data = {\r\n                            \"userId\": req.userId\r\n                        };\r\n                        var loginPack = imClient.buildMessagePack(0x2328, data);\r\n                        conn.send(loginPack.pack(false));\r\n                    }\r\n                };\r\n                conn.onerror = function (error) {\r\n                    clearTimeout(tr);\r\n                    Logger_1[\"default\"].error(error);\r\n                    resolve({ success: false, err: error, conn: conn });\r\n                };\r\n                conn.onmessage = function (evt) {\r\n                    if (typeof evt.data === 'string') {\r\n                        Logger_1[\"default\"].info(\"Received: '\" + evt.data + \"'\");\r\n                        return;\r\n                    }\r\n                    clearTimeout(tr);\r\n                    var bytebuf = new ByteBuffer_1[\"default\"](evt.data);\r\n                    var byteBuffer = bytebuf.int32().int32().unpack();\r\n                    var command = byteBuffer[0];\r\n                    var bodyLen = byteBuffer[1];\r\n                    if (command == 0x2329) {\r\n                        resolve({ success: true, conn: conn });\r\n                    }\r\n                };\r\n            })];\r\n    });\r\n}); };\r\nexports.getLen = function (str) {\r\n    var len = 0;\r\n    for (var i = 0; i < str.length; i++) {\r\n        var c = str.charCodeAt(i);\r\n        //单字节加1\r\n        if ((c >= 0x0001 && c <= 0x007e) || (0xff60 <= c && c <= 0xff9f)) {\r\n            len++;\r\n        }\r\n        else {\r\n            len += 3;\r\n        }\r\n    }\r\n    return len;\r\n};\r\nexports.imClient = new ImClient();\r\n","\"use strict\";\r\nexports.__esModule = true;\r\n/**\r\n * 返回平台所用的 fetch 工具\r\n * */\r\nvar Fetch = /** @class */ (function () {\r\n    function Fetch() {\r\n    }\r\n    Fetch.getFetchToolkit = function () {\r\n        var httpFetch;\r\n        // @ts-ignore\r\n        if (typeof global.fetch !== 'undefined' && typeof global.fetch === 'function') {\r\n            // @ts-ignore\r\n            httpFetch = global.fetch;\r\n        }\r\n        else if (typeof fetch === 'function') {\r\n            httpFetch = fetch; // RN FETCH\r\n        }\r\n        else {\r\n            var uniFetch = require(\"../uniapp/http/uni-fetch\");\r\n            httpFetch = uniFetch.fetch;\r\n        }\r\n        return httpFetch;\r\n    };\r\n    return Fetch;\r\n}());\r\nexports[\"default\"] = Fetch;\r\n","\"use strict\";\r\nexports.__esModule = true;\r\nexports.im = void 0;\r\nvar ImClient_1 = require(\"./lim/core/ImClient\");\r\nexports.im = ImClient_1.imClient;\r\n// if(typeof window !== 'undefined'){\r\n//     console.log(\"window\");\r\n// }\r\n// if(typeof global !== 'undefined'){\r\n//     console.log(\"global\");\r\n// }\r\n// @ts-ignore\r\nif (typeof uni !== 'undefined') {\r\n    // console.log(\"uni\");\r\n    // @ts-ignore\r\n    uni['im'] = ImClient_1.imClient;\r\n    // @ts-ignore\r\n    // uni['im_webtoolkit'] = WebToolkit;\r\n}\r\n","\"use strict\";\r\nexports.__esModule = true;\r\nvar ByteBuffer = /** @class */ (function () {\r\n    function ByteBuffer(arrayBuf, offset) {\r\n        this.Type_Byte = 1;\r\n        this.Type_Short = 2;\r\n        this.Type_UShort = 3;\r\n        this.Type_Int32 = 4;\r\n        this.Type_UInt32 = 5;\r\n        this.Type_String = 6; //变长字符串，前两个字节表示长度\r\n        this.Type_VString = 7; //定长字符串\r\n        this.Type_Int64 = 8;\r\n        this.Type_Float = 9;\r\n        this.Type_Double = 10;\r\n        this.Type_ByteArray = 11;\r\n        this._offset = 0;\r\n        this._list = [];\r\n        this._littleEndian = false;\r\n        this._org_buf = arrayBuf ? (arrayBuf.constructor == DataView ? arrayBuf\r\n            : (arrayBuf.constructor == Uint8Array ? new DataView(arrayBuf.buffer, offset) : new DataView(arrayBuf, offset))) : new DataView(new Uint8Array([]).buffer);\r\n        this.arrayBuf = arrayBuf;\r\n        this.offset = offset;\r\n        // if (!ArrayBuffer.prototype.slice) {\r\n        //     ArrayBuffer.prototype.slice = function (start, end) {\r\n        //         var that = new Uint8Array(this);\r\n        //         if (end == undefined) end = that.length;\r\n        //         var result = new ArrayBuffer(end - start);\r\n        //         var resultArray = new Uint8Array(result);\r\n        //         for (var i = 0; i < resultArray.length; i++)\r\n        //             resultArray[i] = that[i + start];\r\n        //         return result;\r\n        //     }\r\n        // }\r\n    }\r\n    //指定字节序 为BigEndian\r\n    ByteBuffer.prototype.bigEndian = function () {\r\n        this._littleEndian = false;\r\n        return this;\r\n    };\r\n    ;\r\n    //指定字节序 为LittleEndian\r\n    ByteBuffer.prototype.littleEndianfunction = function () {\r\n        this._littleEndian = true;\r\n        return this;\r\n    };\r\n    ;\r\n    ByteBuffer.prototype.utf8Write = function (view, offset, str) {\r\n        var c = 0;\r\n        for (var i = 0, l = str.length; i < l; i++) {\r\n            c = str.charCodeAt(i);\r\n            if (c < 0x80) {\r\n                view.setUint8(offset++, c);\r\n            }\r\n            else if (c < 0x800) {\r\n                view.setUint8(offset++, 0xc0 | (c >> 6));\r\n                view.setUint8(offset++, 0x80 | (c & 0x3f));\r\n            }\r\n            else if (c < 0xd800 || c >= 0xe000) {\r\n                view.setUint8(offset++, 0xe0 | (c >> 12));\r\n                view.setUint8(offset++, 0x80 | (c >> 6) & 0x3f);\r\n                view.setUint8(offset++, 0x80 | (c & 0x3f));\r\n            }\r\n            else {\r\n                i++;\r\n                c = 0x10000 + (((c & 0x3ff) << 10) | (str.charCodeAt(i) & 0x3ff));\r\n                view.setUint8(offset++, 0xf0 | (c >> 18));\r\n                view.setUint8(offset++, 0x80 | (c >> 12) & 0x3f);\r\n                view.setUint8(offset++, 0x80 | (c >> 6) & 0x3f);\r\n                view.setUint8(offset++, 0x80 | (c & 0x3f));\r\n            }\r\n        }\r\n    };\r\n    // byte (val, index) {\r\n    //     if (arguments.length == 0) {\r\n    //         this._list.push(this._org_buf.getUint8(this._offset, this._littleEndian));\r\n    //         this._offset += 1;\r\n    //     } else {\r\n    //         this._list.splice(index != undefined ? index : this._list.length, 0);\r\n    //         this._offset += 1;\r\n    //     }\r\n    //     return this;\r\n    // };\r\n    // short(val:number, index:number) {\r\n    //     if (arguments.length == 0) {\r\n    //         this._list.push(this._org_buf.getInt16(this._offset, this._littleEndian));\r\n    //         this._offset += 2;\r\n    //     } else {\r\n    //         this._list.splice(index != undefined ? index : this._list.length, 0, this.Type_Short);\r\n    //         this._offset += 2;\r\n    //     }\r\n    //     return this;\r\n    // };\r\n    // ushort(val, index) {\r\n    //     if (arguments.length == 0) {\r\n    //         this._list.push(this._org_buf.getUint16(this._offset, this._littleEndian));\r\n    //         this._offset += 2;\r\n    //     } else {\r\n    //         // , {t: this.Type_UShort, d: val, l: 2}\r\n    //         this._list.splice(index != undefined ? index : this._list.length, 0);\r\n    //         this._offset += 2;\r\n    //     }\r\n    //     return this;\r\n    // };\r\n    ByteBuffer.prototype.int32 = function (val, index) {\r\n        if (arguments.length == 0) {\r\n            this._list.push(this._org_buf.getInt32(this._offset, this._littleEndian));\r\n            this._offset += 4;\r\n        }\r\n        else {\r\n            this._list.splice(index != undefined ? index : this._list.length, 0, { t: this.Type_Int32, d: val, l: 4 });\r\n            this._offset += 4;\r\n        }\r\n        return this;\r\n    };\r\n    ;\r\n    ByteBuffer.prototype.uint32 = function (val, index) {\r\n        if (arguments.length == 0) {\r\n            this._list.push(this._org_buf.getUint32(this._offset, this._littleEndian));\r\n            this._offset += 4;\r\n        }\r\n        else {\r\n            this._list.splice(index != undefined ? index : this._list.length, 0, { t: this.Type_UInt32, d: val, l: 4 });\r\n            this._offset += 4;\r\n        }\r\n        return this;\r\n    };\r\n    ;\r\n    /**\r\n     * 新加的方法，获取bytebuffer的长度\r\n     */\r\n    ByteBuffer.prototype.blength = function () {\r\n        return this._offset;\r\n    };\r\n    ;\r\n    /**\r\n         * 变长字符串 前4个字节表示字符串长度\r\n         **/\r\n    ByteBuffer.prototype.string = function (val, index) {\r\n        if (arguments.length == 0) {\r\n            var len = this._org_buf.getInt32(this._offset, this._littleEndian);\r\n            this._offset += 4;\r\n            this._list.push(this.utf8Read(this._org_buf, this._offset, len));\r\n            this._offset += len;\r\n        }\r\n        else {\r\n            var len = 0;\r\n            if (val) {\r\n                len = this.utf8Length(val);\r\n            }\r\n            this._list.splice(index != undefined ? index : this._list.length, 0, { t: this.Type_String, d: val, l: len });\r\n            this._offset += len + 4;\r\n        }\r\n        return this;\r\n    };\r\n    ;\r\n    ByteBuffer.prototype.utf8Length = function (str) {\r\n        var c = 0, length = 0;\r\n        for (var i = 0, l = str.length; i < l; i++) {\r\n            c = str.charCodeAt(i);\r\n            if (c < 0x80) {\r\n                length += 1;\r\n            }\r\n            else if (c < 0x800) {\r\n                length += 2;\r\n            }\r\n            else if (c < 0xd800 || c >= 0xe000) {\r\n                length += 3;\r\n            }\r\n            else {\r\n                i++;\r\n                length += 4;\r\n            }\r\n        }\r\n        return length;\r\n    };\r\n    ByteBuffer.prototype.utf8Read = function (view, offset, length) {\r\n        var string = '', chr = 0;\r\n        for (var i = offset, end = offset + length; i < end; i++) {\r\n            var byte = view.getUint8(i);\r\n            if ((byte & 0x80) === 0x00) {\r\n                string += String.fromCharCode(byte);\r\n                continue;\r\n            }\r\n            if ((byte & 0xe0) === 0xc0) {\r\n                string += String.fromCharCode(((byte & 0x0f) << 6) |\r\n                    (view.getUint8(++i) & 0x3f));\r\n                continue;\r\n            }\r\n            if ((byte & 0xf0) === 0xe0) {\r\n                string += String.fromCharCode(((byte & 0x0f) << 12) |\r\n                    ((view.getUint8(++i) & 0x3f) << 6) |\r\n                    ((view.getUint8(++i) & 0x3f) << 0));\r\n                continue;\r\n            }\r\n            if ((byte & 0xf8) === 0xf0) {\r\n                chr = ((byte & 0x07) << 18) |\r\n                    ((view.getUint8(++i) & 0x3f) << 12) |\r\n                    ((view.getUint8(++i) & 0x3f) << 6) |\r\n                    ((view.getUint8(++i) & 0x3f) << 0);\r\n                if (chr >= 0x010000) { // surrogate pair\r\n                    chr -= 0x010000;\r\n                    string += String.fromCharCode((chr >>> 10) + 0xD800, (chr & 0x3FF) + 0xDC00);\r\n                }\r\n                else {\r\n                    string += String.fromCharCode(chr);\r\n                }\r\n                continue;\r\n            }\r\n            throw new Error('Invalid byte ' + byte.toString(16));\r\n        }\r\n        return string;\r\n    };\r\n    /**\r\n     * 定长字符串 val为null时，读取定长字符串（需指定长度len）\r\n     **/\r\n    ByteBuffer.prototype.vstring = function (val, len, index) {\r\n        if (!len) {\r\n            throw new Error('vstring must got len argument');\r\n            return this;\r\n        }\r\n        if (val == undefined || val == null) {\r\n            var vlen = 0; //实际长度\r\n            for (var i = this._offset; i < this._offset + len; i++) {\r\n                if (this._org_buf.getUint8(i) > 0)\r\n                    vlen++;\r\n            }\r\n            this._list.push(this.utf8Read(this._org_buf, this._offset, vlen));\r\n            this._offset += len;\r\n        }\r\n        else {\r\n            this._list.splice(index != undefined ? index : this._list.length, 0, { t: this.Type_VString, d: val, l: len });\r\n            this._offset += len;\r\n        }\r\n        return this;\r\n    };\r\n    ;\r\n    ByteBuffer.prototype.int64 = function (val, index) {\r\n        if (arguments.length == 0) {\r\n            this._list.push(this._org_buf.getFloat64(this._offset, this._littleEndian));\r\n            this._offset += 8;\r\n        }\r\n        else {\r\n            this._list.splice(index != undefined ? index : this._list.length, 0, { t: this.Type_Int64, d: val, l: 8 });\r\n            this._offset += 8;\r\n        }\r\n        return this;\r\n    };\r\n    ;\r\n    ByteBuffer.prototype.float = function (val, index) {\r\n        if (arguments.length == 0) {\r\n            this._list.push(this._org_buf.getFloat32(this._offset, this._littleEndian));\r\n            this._offset += 4;\r\n        }\r\n        else {\r\n            this._list.splice(index != undefined ? index : this._list.length, 0, { t: this.Type_Float, d: val, l: 4 });\r\n            this._offset += 4;\r\n        }\r\n        return this;\r\n    };\r\n    ;\r\n    ByteBuffer.prototype.double = function (val, index) {\r\n        if (arguments.length == 0) {\r\n            this._list.push(this._org_buf.getFloat64(this._offset, this._littleEndian));\r\n            this._offset += 8;\r\n        }\r\n        else {\r\n            this._list.splice(index != undefined ? index : this._list.length, 0, { t: this.Type_Double, d: val, l: 8 });\r\n            this._offset += 8;\r\n        }\r\n        return this;\r\n    };\r\n    ;\r\n    /**\r\n     * 写入或读取一段字节数组\r\n     **/\r\n    ByteBuffer.prototype.byteArray = function (val, len, index) {\r\n        if (!len) {\r\n            throw new Error('byteArray must got len argument');\r\n            return this;\r\n        }\r\n        if (val == undefined || val == null) {\r\n            var arr = new Uint8Array(this._org_buf.buffer.slice(this._offset, this._offset + len));\r\n            this._list.push(arr);\r\n            this._offset += len;\r\n        }\r\n        else {\r\n            this._list.splice(index != undefined ? index : this._list.length, 0, { t: this.Type_ByteArray, d: val, l: len });\r\n            this._offset += len;\r\n        }\r\n        return this;\r\n    };\r\n    ;\r\n    /**\r\n     * 解包成数据数组\r\n     **/\r\n    ByteBuffer.prototype.unpack = function () {\r\n        return this._list;\r\n    };\r\n    ;\r\n    /**\r\n     * 打包成二进制,在前面加上4个字节表示包长\r\n     **/\r\n    ByteBuffer.prototype.packWithHead = function () {\r\n        return this.pack(true);\r\n    };\r\n    ;\r\n    /**\r\n         * 打包成二进制\r\n         * @param ifHead 是否在前面加上4个字节表示包长\r\n         **/\r\n    ByteBuffer.prototype.pack = function (ifHead) {\r\n        this._org_buf = new DataView(new ArrayBuffer((ifHead) ? this._offset + 4 : this._offset));\r\n        var offset = 0;\r\n        if (ifHead) {\r\n            this._org_buf.setUint32(offset, this._offset, this._littleEndian);\r\n            offset += 4;\r\n        }\r\n        for (var i = 0; i < this._list.length; i++) {\r\n            switch (this._list[i].t) {\r\n                case this.Type_Byte:\r\n                    this._org_buf.setInt8(offset, this._list[i].d);\r\n                    offset += this._list[i].l;\r\n                    break;\r\n                case this.Type_Short:\r\n                    this._org_buf.setInt16(offset, this._list[i].d, this._littleEndian);\r\n                    offset += this._list[i].l;\r\n                    break;\r\n                case this.Type_UShort:\r\n                    this._org_buf.setUint16(offset, this._list[i].d, this._littleEndian);\r\n                    offset += this._list[i].l;\r\n                    break;\r\n                case this.Type_Int32:\r\n                    this._org_buf.setInt32(offset, this._list[i].d, this._littleEndian);\r\n                    offset += this._list[i].l;\r\n                    break;\r\n                case this.Type_UInt32:\r\n                    this._org_buf.setUint32(offset, this._list[i].d, this._littleEndian);\r\n                    offset += this._list[i].l;\r\n                    break;\r\n                case this.Type_String:\r\n                    //前4个字节表示字符串长度\r\n                    this._org_buf.setUint32(offset, this._list[i].l, this._littleEndian);\r\n                    offset += 4;\r\n                    this.utf8Write(this._org_buf, offset, this._list[i].d);\r\n                    offset += this._list[i].l;\r\n                    break;\r\n                case this.Type_VString:\r\n                    this.utf8Write(this._org_buf, offset, this._list[i].d);\r\n                    var vlen = this.utf8Length(this._list[i].d); //字符串实际长度\r\n                    //补齐\\0\r\n                    for (var j = offset + vlen; j < offset + this._list[i].l; j++) {\r\n                        this._org_buf.setUint8(j, 0);\r\n                    }\r\n                    offset += this._list[i].l;\r\n                    break;\r\n                case this.Type_Int64:\r\n                    this._org_buf.setFloat64(offset, this._list[i].d, this._littleEndian);\r\n                    offset += this._list[i].l;\r\n                    break;\r\n                case this.Type_Float:\r\n                    this._org_buf.setFloat32(offset, this._list[i].d, this._littleEndian);\r\n                    offset += this._list[i].l;\r\n                    break;\r\n                case this.Type_Double:\r\n                    this._org_buf.setFloat64(offset, this._list[i].d, this._littleEndian);\r\n                    offset += this._list[i].l;\r\n                    break;\r\n                case this.Type_ByteArray:\r\n                    var indx = 0;\r\n                    for (var j = offset; j < offset + this._list[i].l; j++) {\r\n                        if (indx < this._list[i].d.length) {\r\n                            this._org_buf.setUint8(j, this._list[i].d[indx]);\r\n                        }\r\n                        else { //不够的话，后面补齐0x00\r\n                            this._org_buf.setUint8(j, 0);\r\n                        }\r\n                        indx++;\r\n                    }\r\n                    offset += this._list[i].l;\r\n                    break;\r\n            }\r\n        }\r\n        return this._org_buf.buffer;\r\n    };\r\n    ;\r\n    /**\r\n     * 未读数据长度\r\n     **/\r\n    ByteBuffer.prototype.getAvailable = function () {\r\n        if (!this._org_buf)\r\n            return this._offset;\r\n        return this._org_buf.buffer.byteLength - this._offset;\r\n    };\r\n    ;\r\n    return ByteBuffer;\r\n}());\r\nexports[\"default\"] = ByteBuffer;\r\n","\"use strict\";\r\nexports.__esModule = true;\r\nexports.LoginPack = void 0;\r\nvar LoginPack = /** @class */ (function () {\r\n    function LoginPack(appId, userId, clientType) {\r\n        this.userId = userId;\r\n        this.clientType = clientType;\r\n        this.appId = appId;\r\n    }\r\n    return LoginPack;\r\n}());\r\nexports.LoginPack = LoginPack;\r\n","\"use strict\";\r\nexports.__esModule = true;\r\nvar Fetch_1 = require(\"../common/Fetch\");\r\nvar Logger_1 = require(\"../log/Logger\");\r\nvar Base64 = {\r\n    _keyStr: \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=\",\r\n    encode: function (e) {\r\n        var t = \"\";\r\n        var n, r, i, s, o, u, a;\r\n        var f = 0;\r\n        e = Base64._utf8_encode(e);\r\n        while (f < e.length) {\r\n            n = e.charCodeAt(f++);\r\n            r = e.charCodeAt(f++);\r\n            i = e.charCodeAt(f++);\r\n            s = n >> 2;\r\n            o = (n & 3) << 4 | r >> 4;\r\n            u = (r & 15) << 2 | i >> 6;\r\n            a = i & 63;\r\n            if (isNaN(r)) {\r\n                u = a = 64;\r\n            }\r\n            else if (isNaN(i)) {\r\n                a = 64;\r\n            }\r\n            t = t + this._keyStr.charAt(s) + this._keyStr.charAt(o) + this._keyStr.charAt(u) + this._keyStr.charAt(a);\r\n        }\r\n        return t;\r\n    },\r\n    decode: function (e) {\r\n        var t = \"\";\r\n        var n, r, i;\r\n        var s, o, u, a;\r\n        var f = 0;\r\n        e = e.replace(/[^A-Za-z0-9+/=]/g, \"\");\r\n        while (f < e.length) {\r\n            s = this._keyStr.indexOf(e.charAt(f++));\r\n            o = this._keyStr.indexOf(e.charAt(f++));\r\n            u = this._keyStr.indexOf(e.charAt(f++));\r\n            a = this._keyStr.indexOf(e.charAt(f++));\r\n            n = s << 2 | o >> 4;\r\n            r = (o & 15) << 4 | u >> 2;\r\n            i = (u & 3) << 6 | a;\r\n            t = t + String.fromCharCode(n);\r\n            if (u != 64) {\r\n                t = t + String.fromCharCode(r);\r\n            }\r\n            if (a != 64) {\r\n                t = t + String.fromCharCode(i);\r\n            }\r\n        }\r\n        t = Base64._utf8_decode(t);\r\n        return t;\r\n    },\r\n    _utf8_encode: function (e) {\r\n        e = e.replace(/rn/g, \"n\");\r\n        var t = \"\";\r\n        for (var n = 0; n < e.length; n++) {\r\n            var r = e.charCodeAt(n);\r\n            if (r < 128) {\r\n                t += String.fromCharCode(r);\r\n            }\r\n            else if (r > 127 && r < 2048) {\r\n                t += String.fromCharCode(r >> 6 | 192);\r\n                t += String.fromCharCode(r & 63 | 128);\r\n            }\r\n            else {\r\n                t += String.fromCharCode(r >> 12 | 224);\r\n                t += String.fromCharCode(r >> 6 & 63 | 128);\r\n                t += String.fromCharCode(r & 63 | 128);\r\n            }\r\n        }\r\n        return t;\r\n    },\r\n    _utf8_decode: function (e) {\r\n        var t = \"\";\r\n        var n = 0;\r\n        var r = 0;\r\n        var c1 = 0;\r\n        var c2 = 0;\r\n        while (n < e.length) {\r\n            r = e.charCodeAt(n);\r\n            if (r < 128) {\r\n                t += String.fromCharCode(r);\r\n                n++;\r\n            }\r\n            else if (r > 191 && r < 224) {\r\n                c2 = e.charCodeAt(n + 1);\r\n                t += String.fromCharCode((r & 31) << 6 | c2 & 63);\r\n                n += 2;\r\n            }\r\n            else {\r\n                c2 = e.charCodeAt(n + 1);\r\n                var c3 = e.charCodeAt(n + 2);\r\n                t += String.fromCharCode((r & 15) << 12 | (c2 & 63) << 6 | c3 & 63);\r\n                n += 3;\r\n            }\r\n        }\r\n        return t;\r\n    }\r\n};\r\nvar WebToolkit = /** @class */ (function () {\r\n    function WebToolkit() {\r\n    }\r\n    // 获取浏览器信息\r\n    WebToolkit.getBrowserInfo = function () {\r\n        var agent = navigator.userAgent.toLowerCase();\r\n        var system = agent.split(\" \")[1].split(\" \")[0].split(\"(\")[1];\r\n        var REGSTR_EDGE = /edge\\/[\\d.]+/gi;\r\n        var REGSTR_IE = /trident\\/[\\d.]+/gi;\r\n        var OLD_IE = /msie\\s[\\d.]+/gi;\r\n        var REGSTR_FF = /firefox\\/[\\d.]+/gi;\r\n        var REGSTR_CHROME = /chrome\\/[\\d.]+/gi;\r\n        var REGSTR_SAF = /safari\\/[\\d.]+/gi;\r\n        var REGSTR_OPERA = /opr\\/[\\d.]+/gi;\r\n        var info = {\r\n            code: 0,\r\n            system: system,\r\n            browser: \"\",\r\n            browserVersion: \"\"\r\n        };\r\n        // IE\r\n        if (agent.indexOf(\"trident\") > 0) {\r\n            info.browser = agent.match(REGSTR_IE)[0].split(\"/\")[0];\r\n            info.browserVersion = agent.match(REGSTR_IE)[0].split(\"/\")[1];\r\n            return info;\r\n        }\r\n        // OLD_IE\r\n        if (agent.indexOf(\"msie\") > 0) {\r\n            info.browser = agent.match(OLD_IE)[0].split(\" \")[0];\r\n            info.browserVersion = agent.match(OLD_IE)[0].split(\" \")[1];\r\n            return info;\r\n        }\r\n        // Edge\r\n        if (agent.indexOf(\"edge\") > 0) {\r\n            info.browser = agent.match(REGSTR_EDGE)[0].split(\"/\")[0];\r\n            info.browserVersion = agent.match(REGSTR_EDGE)[0].split(\"/\")[1];\r\n            return info;\r\n        }\r\n        // firefox\r\n        if (agent.indexOf(\"firefox\") > 0) {\r\n            info.browser = agent.match(REGSTR_FF)[0].split(\"/\")[0];\r\n            info.browserVersion = agent.match(REGSTR_FF)[0].split(\"/\")[1];\r\n            return info;\r\n        }\r\n        // Opera\r\n        if (agent.indexOf(\"opr\") > 0) {\r\n            info.browser = agent.match(REGSTR_OPERA)[0].split(\"/\")[0];\r\n            info.browserVersion = agent.match(REGSTR_OPERA)[0].split(\"/\")[1];\r\n            return info;\r\n        }\r\n        // Safari\r\n        if (agent.indexOf(\"safari\") > 0 && agent.indexOf(\"chrome\") < 0) {\r\n            info.browser = agent.match(REGSTR_SAF)[0].split(\"/\")[0];\r\n            info.browserVersion = agent.match(REGSTR_SAF)[0].split(\"/\")[1];\r\n            return info;\r\n        }\r\n        // Chrome\r\n        if (agent.indexOf(\"chrome\") > 0) {\r\n            info.browser = agent.match(REGSTR_CHROME)[0].split(\"/\")[0];\r\n            info.browserVersion = agent.match(REGSTR_CHROME)[0].split(\"/\")[1];\r\n            return info;\r\n        }\r\n        else {\r\n            info.code = -1;\r\n            return info;\r\n        }\r\n    };\r\n    // TODO: 获取小程序设备信息\r\n    WebToolkit.getWxappInfo = function () {\r\n        return {\r\n            system: 'WXAPP',\r\n            browser: 'WXAPP',\r\n            browserVersion: '1.0'\r\n        };\r\n    };\r\n    // TODO: 获取ReactNative设备信息\r\n    WebToolkit.getReactNativeInfo = function () {\r\n        return {\r\n            system: 'RNNative',\r\n            browser: 'RNNative',\r\n            browserVersion: '1.0'\r\n        };\r\n    };\r\n    // TODO: 获取UniApp设备信息\r\n    WebToolkit.getUniAppInfo = function () {\r\n        return {\r\n            system: 'UNIAPP',\r\n            browser: 'UNIAPP',\r\n            browserVersion: '1.0'\r\n        };\r\n    };\r\n    // 动态加入script 到head 标签处\r\n    WebToolkit.loadJS = function (url, callback) {\r\n        var script = document.createElement('script'), fn = callback || function () { };\r\n        script.type = 'text/javascript';\r\n        // document.getElementsByTagName('head')[0].children[16].outerHTML.indexOf('http://pv.sohu.com/cityjson?ie=utf-8')\r\n        var exist = false;\r\n        for (var v in document.getElementsByTagName('head')[0].children) {\r\n            var dom = document.getElementsByTagName('head')[0].children[v];\r\n            if (dom.outerHTML !== undefined && dom.outerHTML.indexOf(url) >= 0) {\r\n                exist = true;\r\n            }\r\n        }\r\n        if (exist) {\r\n            fn();\r\n            return;\r\n        }\r\n        //IE\r\n        if (script.readyState) {\r\n            script.onreadystatechange = function () {\r\n                if (script.readyState == 'loaded' || script.readyState == 'complete') {\r\n                    script.onreadystatechange = null;\r\n                    fn();\r\n                }\r\n            };\r\n        }\r\n        else {\r\n            //其他浏览器\r\n            script.onload = function () {\r\n                fn();\r\n            };\r\n        }\r\n        script.src = url;\r\n        document.getElementsByTagName('head')[0].appendChild(script);\r\n    };\r\n    // 获取当前ip信息(fetch方式)\r\n    WebToolkit.getIpInfoByFetch = function (callback) {\r\n        var url = 'http://pv.sohu.com/cityjson?ie=utf-8';\r\n        var fetch = Fetch_1[\"default\"].getFetchToolkit();\r\n        var request = { method: \"GET\", mode: \"cors\", headers: { \"Content-Type\": \"application/json\" } };\r\n        return fetch(url, request).then(function (response) {\r\n            return response.text();\r\n        }).then(function (res) {\r\n            if (typeof callback === 'function') {\r\n                var currentCity = eval('_current_city=' + res.replace('var returnCitySN = ', ''));\r\n                callback(currentCity);\r\n            }\r\n        })[\"catch\"](function (e) {\r\n            Logger_1[\"default\"].trace(e);\r\n        });\r\n    };\r\n    // 获取当前ip信息(动态插入script脚本方式)\r\n    WebToolkit.getIpInfoByInsertScript = function (callback) {\r\n        var url = 'http://pv.sohu.com/cityjson?ie=utf-8';\r\n        WebToolkit.loadJS(url, function () {\r\n            callback(window['returnCitySN']);\r\n        });\r\n    };\r\n    WebToolkit.getIpInfo = function (callback) {\r\n        // 小程序的情况需要把pv.sohu.com域名加入白名单中\r\n        WebToolkit.getIpInfoByFetch(callback);\r\n    };\r\n    // 获取客户端设备信息\r\n    WebToolkit.getDeviceInfo = function () {\r\n        var deviceInfo = WebToolkit.getUniAppInfo();\r\n        return deviceInfo;\r\n    };\r\n    WebToolkit.base64Encode = function (str) {\r\n        return Base64.encode(str);\r\n    };\r\n    WebToolkit.base64Decode = function (str) {\r\n        return Base64.decode(str);\r\n    };\r\n    return WebToolkit;\r\n}());\r\nexports[\"default\"] = WebToolkit;\r\n","var g;\n\n// This works in non-strict mode\ng = (function() {\n\treturn this;\n})();\n\ntry {\n\t// This works if eval is allowed (see CSP)\n\tg = g || new Function(\"return this\")();\n} catch (e) {\n\t// This works if the window reference is available\n\tif (typeof window === \"object\") g = window;\n}\n\n// g can still be undefined, but nothing to do about it...\n// We return undefined, instead of nothing here, so it's\n// easier to handle this case. if(!global) { ...}\n\nmodule.exports = g;\n","var global =\r\n  (typeof globalThis !== 'undefined' && globalThis) ||\r\n  (typeof self !== 'undefined' && self) ||\r\n  (typeof global !== 'undefined' && global)\r\n\r\nvar support = {\r\n  searchParams: 'URLSearchParams' in global,\r\n  iterable: 'Symbol' in global && 'iterator' in Symbol,\r\n  blob:\r\n    'FileReader' in global &&\r\n    'Blob' in global &&\r\n    (function() {\r\n      try {\r\n        new Blob()\r\n        return true\r\n      } catch (e) {\r\n        return false\r\n      }\r\n    })(),\r\n  formData: 'FormData' in global,\r\n  arrayBuffer: 'ArrayBuffer' in global\r\n}\r\n\r\nfunction isDataView(obj) {\r\n  return obj && DataView.prototype.isPrototypeOf(obj)\r\n}\r\n\r\nif (support.arrayBuffer) {\r\n  var viewClasses = [\r\n    '[object Int8Array]',\r\n    '[object Uint8Array]',\r\n    '[object Uint8ClampedArray]',\r\n    '[object Int16Array]',\r\n    '[object Uint16Array]',\r\n    '[object Int32Array]',\r\n    '[object Uint32Array]',\r\n    '[object Float32Array]',\r\n    '[object Float64Array]'\r\n  ]\r\n\r\n  var isArrayBufferView =\r\n    ArrayBuffer.isView ||\r\n    function(obj) {\r\n      return obj && viewClasses.indexOf(Object.prototype.toString.call(obj)) > -1\r\n    }\r\n}\r\n\r\nfunction normalizeName(name) {\r\n  if (typeof name !== 'string') {\r\n    name = String(name)\r\n  }\r\n  if (/[^a-z0-9\\-#$%&'*+.^_`|~!]/i.test(name) || name === '') {\r\n    throw new TypeError('Invalid character in header field name: \"' + name + '\"')\r\n  }\r\n  // return name.toLowerCase()\r\n  return name;\r\n}\r\n\r\nfunction normalizeValue(value) {\r\n  if (typeof value !== 'string') {\r\n    value = String(value)\r\n  }\r\n  return value\r\n}\r\n\r\n// Build a destructive iterator for the value list\r\nfunction iteratorFor(items) {\r\n  var iterator = {\r\n    next: function() {\r\n      var value = items.shift()\r\n      return {done: value === undefined, value: value}\r\n    }\r\n  }\r\n\r\n  if (support.iterable) {\r\n    iterator[Symbol.iterator] = function() {\r\n      return iterator\r\n    }\r\n  }\r\n\r\n  return iterator\r\n}\r\n\r\nexport function Headers(headers) {\r\n  this.map = {}\r\n\r\n  if (headers instanceof Headers) {\r\n    headers.forEach(function(value, name) {\r\n      this.append(name, value)\r\n    }, this)\r\n  } else if (Array.isArray(headers)) {\r\n    headers.forEach(function(header) {\r\n      this.append(header[0], header[1])\r\n    }, this)\r\n  } else if (headers) {\r\n    Object.getOwnPropertyNames(headers).forEach(function(name) {\r\n      this.append(name, headers[name])\r\n    }, this)\r\n  }\r\n}\r\n\r\nHeaders.prototype.append = function(name, value) {\r\n  name = normalizeName(name)\r\n  value = normalizeValue(value)\r\n  var oldValue = this.map[name]\r\n  this.map[name] = oldValue ? oldValue + ', ' + value : value\r\n}\r\n\r\nHeaders.prototype['delete'] = function(name) {\r\n  delete this.map[normalizeName(name)]\r\n}\r\n\r\nHeaders.prototype.get = function(name) {\r\n  name = normalizeName(name)\r\n  return this.has(name) ? this.map[name] : null\r\n}\r\n\r\nHeaders.prototype.has = function(name) {\r\n  return this.map.hasOwnProperty(normalizeName(name))\r\n}\r\n\r\nHeaders.prototype.set = function(name, value) {\r\n  this.map[normalizeName(name)] = normalizeValue(value)\r\n}\r\n\r\nHeaders.prototype.forEach = function(callback, thisArg) {\r\n  for (var name in this.map) {\r\n    if (this.map.hasOwnProperty(name)) {\r\n      callback.call(thisArg, this.map[name], name, this)\r\n    }\r\n  }\r\n}\r\n\r\nHeaders.prototype.keys = function() {\r\n  var items = []\r\n  this.forEach(function(value, name) {\r\n    items.push(name)\r\n  })\r\n  return iteratorFor(items)\r\n}\r\n\r\nHeaders.prototype.values = function() {\r\n  var items = []\r\n  this.forEach(function(value) {\r\n    items.push(value)\r\n  })\r\n  return iteratorFor(items)\r\n}\r\n\r\nHeaders.prototype.entries = function() {\r\n  var items = []\r\n  this.forEach(function(value, name) {\r\n    items.push([name, value])\r\n  })\r\n  return iteratorFor(items)\r\n}\r\n\r\nif (support.iterable) {\r\n  Headers.prototype[Symbol.iterator] = Headers.prototype.entries\r\n}\r\n\r\nfunction consumed(body) {\r\n  if (body.bodyUsed) {\r\n    return Promise.reject(new TypeError('Already read'))\r\n  }\r\n  body.bodyUsed = true\r\n}\r\n\r\nfunction fileReaderReady(reader) {\r\n  return new Promise(function(resolve, reject) {\r\n    reader.onload = function() {\r\n      resolve(reader.result)\r\n    }\r\n    reader.onerror = function() {\r\n      reject(reader.error)\r\n    }\r\n  })\r\n}\r\n\r\nfunction readBlobAsArrayBuffer(blob) {\r\n  var reader = new FileReader()\r\n  var promise = fileReaderReady(reader)\r\n  reader.readAsArrayBuffer(blob)\r\n  return promise\r\n}\r\n\r\nfunction readBlobAsText(blob) {\r\n  var reader = new FileReader()\r\n  var promise = fileReaderReady(reader)\r\n  reader.readAsText(blob)\r\n  return promise\r\n}\r\n\r\nfunction readArrayBufferAsText(buf) {\r\n  var view = new Uint8Array(buf)\r\n  var chars = new Array(view.length)\r\n\r\n  for (var i = 0; i < view.length; i++) {\r\n    chars[i] = String.fromCharCode(view[i])\r\n  }\r\n  return chars.join('')\r\n}\r\n\r\nfunction bufferClone(buf) {\r\n  if (buf.slice) {\r\n    return buf.slice(0)\r\n  } else {\r\n    var view = new Uint8Array(buf.byteLength)\r\n    view.set(new Uint8Array(buf))\r\n    return view.buffer\r\n  }\r\n}\r\n\r\nfunction Body() {\r\n  this.bodyUsed = false\r\n\r\n  this._initBody = function(body) {\r\n    /*\r\n      fetch-mock wraps the Response object in an ES6 Proxy to\r\n      provide useful test harness features such as flush. However, on\r\n      ES5 browsers without fetch or Proxy support pollyfills must be used;\r\n      the proxy-pollyfill is unable to proxy an attribute unless it exists\r\n      on the object before the Proxy is created. This change ensures\r\n      Response.bodyUsed exists on the instance, while maintaining the\r\n      semantic of setting Request.bodyUsed in the constructor before\r\n      _initBody is called.\r\n    */\r\n    this.bodyUsed = this.bodyUsed\r\n    this._bodyInit = body\r\n    if (!body) {\r\n      this._bodyText = ''\r\n    } else if (typeof body === 'string') {\r\n      this._bodyText = body\r\n    } else if (support.blob && Blob.prototype.isPrototypeOf(body)) {\r\n      this._bodyBlob = body\r\n    } else if (support.formData && FormData.prototype.isPrototypeOf(body)) {\r\n      this._bodyFormData = body\r\n    } else if (support.searchParams && URLSearchParams.prototype.isPrototypeOf(body)) {\r\n      this._bodyText = body.toString()\r\n    } else if (support.arrayBuffer && support.blob && isDataView(body)) {\r\n      this._bodyArrayBuffer = bufferClone(body.buffer)\r\n      // IE 10-11 can't handle a DataView body.\r\n      this._bodyInit = new Blob([this._bodyArrayBuffer])\r\n    } else if (support.arrayBuffer && (ArrayBuffer.prototype.isPrototypeOf(body) || isArrayBufferView(body))) {\r\n      this._bodyArrayBuffer = bufferClone(body)\r\n    } else {\r\n      this._bodyText = body = Object.prototype.toString.call(body)\r\n    }\r\n\r\n    if (!this.headers.get('Content-Type')) {\r\n      if (typeof body === 'string') {\r\n        this.headers.set('Content-Type', 'text/plain;charset=UTF-8')\r\n      } else if (this._bodyBlob && this._bodyBlob.type) {\r\n        this.headers.set('Content-Type', this._bodyBlob.type)\r\n      } else if (support.searchParams && URLSearchParams.prototype.isPrototypeOf(body)) {\r\n        this.headers.set('Content-Type', 'application/x-www-form-urlencoded;charset=UTF-8')\r\n      }\r\n    }\r\n  }\r\n\r\n  if (support.blob) {\r\n    this.blob = function() {\r\n      var rejected = consumed(this)\r\n      if (rejected) {\r\n        return rejected\r\n      }\r\n\r\n      if (this._bodyBlob) {\r\n        return Promise.resolve(this._bodyBlob)\r\n      } else if (this._bodyArrayBuffer) {\r\n        return Promise.resolve(new Blob([this._bodyArrayBuffer]))\r\n      } else if (this._bodyFormData) {\r\n        throw new Error('could not read FormData body as blob')\r\n      } else {\r\n        return Promise.resolve(new Blob([this._bodyText]))\r\n      }\r\n    }\r\n\r\n    this.arrayBuffer = function() {\r\n      if (this._bodyArrayBuffer) {\r\n        var isConsumed = consumed(this)\r\n        if (isConsumed) {\r\n          return isConsumed\r\n        }\r\n        if (ArrayBuffer.isView(this._bodyArrayBuffer)) {\r\n          return Promise.resolve(\r\n            this._bodyArrayBuffer.buffer.slice(\r\n              this._bodyArrayBuffer.byteOffset,\r\n              this._bodyArrayBuffer.byteOffset + this._bodyArrayBuffer.byteLength\r\n            )\r\n          )\r\n        } else {\r\n          return Promise.resolve(this._bodyArrayBuffer)\r\n        }\r\n      } else {\r\n        return this.blob().then(readBlobAsArrayBuffer)\r\n      }\r\n    }\r\n  }\r\n\r\n  this.text = function() {\r\n    var rejected = consumed(this)\r\n    if (rejected) {\r\n      return rejected\r\n    }\r\n\r\n    if (this._bodyBlob) {\r\n      return readBlobAsText(this._bodyBlob)\r\n    } else if (this._bodyArrayBuffer) {\r\n      return Promise.resolve(readArrayBufferAsText(this._bodyArrayBuffer))\r\n    } else if (this._bodyFormData) {\r\n      throw new Error('could not read FormData body as text')\r\n    } else {\r\n      return Promise.resolve(this._bodyText)\r\n    }\r\n  }\r\n\r\n  if (support.formData) {\r\n    this.formData = function() {\r\n      return this.text().then(decode)\r\n    }\r\n  }\r\n\r\n  this.json = function() {\r\n    return this.text().then(JSON.parse)\r\n  }\r\n\r\n  return this\r\n}\r\n\r\n// HTTP methods whose capitalization should be normalized\r\nvar methods = ['DELETE', 'GET', 'HEAD', 'OPTIONS', 'POST', 'PUT']\r\n\r\nfunction normalizeMethod(method) {\r\n  var upcased = method.toUpperCase()\r\n  return methods.indexOf(upcased) > -1 ? upcased : method\r\n}\r\n\r\nexport function Request(input, options) {\r\n  if (!(this instanceof Request)) {\r\n    throw new TypeError('Please use the \"new\" operator, this DOM object constructor cannot be called as a function.')\r\n  }\r\n\r\n  options = options || {}\r\n  var body = options.body\r\n\r\n  if (input instanceof Request) {\r\n    if (input.bodyUsed) {\r\n      throw new TypeError('Already read')\r\n    }\r\n    this.url = input.url\r\n    this.credentials = input.credentials\r\n    if (!options.headers) {\r\n      this.headers = new Headers(input.headers)\r\n    }\r\n    this.method = input.method\r\n    this.mode = input.mode\r\n    this.signal = input.signal\r\n    if (!body && input._bodyInit != null) {\r\n      body = input._bodyInit\r\n      input.bodyUsed = true\r\n    }\r\n  } else {\r\n    this.url = String(input)\r\n  }\r\n\r\n  this.credentials = options.credentials || this.credentials || 'same-origin'\r\n  if (options.headers || !this.headers) {\r\n    this.headers = new Headers(options.headers)\r\n  }\r\n  this.method = normalizeMethod(options.method || this.method || 'GET')\r\n  this.mode = options.mode || this.mode || null\r\n  this.signal = options.signal || this.signal\r\n  this.referrer = null\r\n\r\n  if ((this.method === 'GET' || this.method === 'HEAD') && body) {\r\n    throw new TypeError('Body not allowed for GET or HEAD requests')\r\n  }\r\n  this._initBody(body)\r\n\r\n  if (this.method === 'GET' || this.method === 'HEAD') {\r\n    if (options.cache === 'no-store' || options.cache === 'no-cache') {\r\n      // Search for a '_' parameter in the query string\r\n      var reParamSearch = /([?&])_=[^&]*/\r\n      if (reParamSearch.test(this.url)) {\r\n        // If it already exists then set the value with the current time\r\n        this.url = this.url.replace(reParamSearch, '$1_=' + new Date().getTime())\r\n      } else {\r\n        // Otherwise add a new '_' parameter to the end with the current time\r\n        var reQueryString = /\\?/\r\n        this.url += (reQueryString.test(this.url) ? '&' : '?') + '_=' + new Date().getTime()\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\nRequest.prototype.clone = function() {\r\n  return new Request(this, {body: this._bodyInit})\r\n}\r\n\r\nfunction decode(body) {\r\n  var form = new FormData()\r\n  body\r\n    .trim()\r\n    .split('&')\r\n    .forEach(function(bytes) {\r\n      if (bytes) {\r\n        var split = bytes.split('=')\r\n        var name = split.shift().replace(/\\+/g, ' ')\r\n        var value = split.join('=').replace(/\\+/g, ' ')\r\n        form.append(decodeURIComponent(name), decodeURIComponent(value))\r\n      }\r\n    })\r\n  return form\r\n}\r\n\r\nfunction parseHeaders(rawHeaders) {\r\n  var headers = new Headers()\r\n  // Replace instances of \\r\\n and \\n followed by at least one space or horizontal tab with a space\r\n  // https://tools.ietf.org/html/rfc7230#section-3.2\r\n  var preProcessedHeaders = rawHeaders.replace(/\\r?\\n[\\t ]+/g, ' ')\r\n  // Avoiding split via regex to work around a common IE11 bug with the core-js 3.6.0 regex polyfill\r\n  // https://github.com/github/fetch/issues/748\r\n  // https://github.com/zloirock/core-js/issues/751\r\n  preProcessedHeaders\r\n    .split('\\r')\r\n    .map(function(header) {\r\n      return header.indexOf('\\n') === 0 ? header.substr(1, header.length) : header\r\n    })\r\n    .forEach(function(line) {\r\n      var parts = line.split(':')\r\n      var key = parts.shift().trim()\r\n      if (key) {\r\n        var value = parts.join(':').trim()\r\n        headers.append(key, value)\r\n      }\r\n    })\r\n  return headers\r\n}\r\n\r\nfunction parseUniappHeaders(rawHeaders) {\r\n  var headers = new Headers()\r\n  for(var key in rawHeaders){\r\n    headers.append(key, rawHeaders[key])\r\n  }\r\n  return headers\r\n}\r\n\r\n\r\nBody.call(Request.prototype)\r\n\r\nexport function Response(bodyInit, options) {\r\n  if (!(this instanceof Response)) {\r\n    throw new TypeError('Please use the \"new\" operator, this DOM object constructor cannot be called as a function.')\r\n  }\r\n  if (!options) {\r\n    options = {}\r\n  }\r\n\r\n  this.type = 'default'\r\n  this.status = options.status === undefined ? 200 : options.status\r\n  this.ok = this.status >= 200 && this.status < 300\r\n  this.statusText = options.statusText === undefined ? '' : '' + options.statusText\r\n  this.headers = new Headers(options.headers)\r\n  this.url = options.url || ''\r\n  this._initBody(bodyInit)\r\n}\r\n\r\nBody.call(Response.prototype)\r\n\r\nResponse.prototype.clone = function() {\r\n  return new Response(this._bodyInit, {\r\n    status: this.status,\r\n    statusText: this.statusText,\r\n    headers: new Headers(this.headers),\r\n    url: this.url\r\n  })\r\n}\r\n\r\nResponse.error = function() {\r\n  var response = new Response(null, {status: 0, statusText: ''})\r\n  response.type = 'error'\r\n  return response\r\n}\r\n\r\nvar redirectStatuses = [301, 302, 303, 307, 308]\r\n\r\nResponse.redirect = function(url, status) {\r\n  if (redirectStatuses.indexOf(status) === -1) {\r\n    throw new RangeError('Invalid status code')\r\n  }\r\n\r\n  return new Response(null, {status: status, headers: {location: url}})\r\n}\r\n\r\nexport var DOMException = global.DOMException\r\ntry {\r\n  new DOMException()\r\n} catch (err) {\r\n  DOMException = function(message, name) {\r\n    this.message = message\r\n    this.name = name\r\n    var error = Error(message)\r\n    this.stack = error.stack\r\n  }\r\n  DOMException.prototype = Object.create(Error.prototype)\r\n  DOMException.prototype.constructor = DOMException\r\n}\r\n\r\n// 从 whatwg-fetch 项目改写\r\nexport function fetch(input, init) {\r\n  return new Promise(function(resolve, reject) {\r\n    var request = new Request(input, init)\r\n\r\n    if (request.signal && request.signal.aborted) {\r\n      return reject(new DOMException('Aborted', 'AbortError'))\r\n    }\r\n\r\n    function fixUrl(url) {\r\n      try {\r\n        return url === '' && global.location.href ? global.location.href : url\r\n      } catch (e) {\r\n        return url\r\n      }\r\n    }\r\n    function isJson(json) {\r\n      try {\r\n        if (typeof json == \"object\") {\r\n          return true;\r\n        }\r\n        if (typeof json == \"string\") {\r\n          if (typeof JSON.parse(str) == \"object\") {\r\n            return true;\r\n          }\r\n        }\r\n      } catch(e) {\r\n      }\r\n      return false;\r\n    }\r\n    function toStr(json) {\r\n      try {\r\n        if (typeof json == \"object\") {\r\n          return JSON.stringify(json);\r\n        }\r\n        if (typeof json == \"string\") {\r\n           return json;\r\n        }\r\n      } catch(e) {\r\n      }\r\n      return json.toString();\r\n    }\r\n\r\n\r\n    let rawBody = typeof request._bodyInit === 'undefined' ? null : request._bodyInit;\r\n    if(request.headers.hasOwnProperty('Content-Type') && request.headers['Content-Type'].indexOf('application/json') >= 0){\r\n       if(request.method.toUpperCase() === 'POST'){\r\n         rawBody = JSON.parse(rawBody); // uniapp框架遇到 method = 'POST' 且 Content-Type = 'application/json' 会自动序列化\r\n       }\r\n    }\r\n    const requestTask = uni.request({\r\n      url: fixUrl(request.url),\r\n      method: request.method,\r\n      data: rawBody,\r\n      header: request.headers.map,\r\n      complete: (resp)=> {\r\n        // Logger.info(resp);\r\n        if (request.signal) {\r\n          request.signal.removeEventListener('abort', abortXhr);\r\n        }\r\n        if(resp.errMsg.indexOf('fail') >= 0){\r\n          setTimeout(function() {\r\n            reject(new TypeError('Network request failed'))\r\n          }, 0);\r\n          return;\r\n        }\r\n        // if(resp.statusCode !== 200){\r\n        //   setTimeout(function() {\r\n        //     reject(new TypeError('Network request failed, statusCode:' + resp.statusCode + \"  full text:\" + JSON.stringify(resp.data)))\r\n        //   }, 0)\r\n        //   return;\r\n        // }\r\n        var options = {\r\n          status: resp.statusCode,\r\n          statusText: resp.data ? toStr(resp.data) : '',\r\n          headers: parseUniappHeaders(resp.header || {})\r\n        };\r\n        options.url = options.headers.get('X-Request-URL')\r\n        var body = options.statusText;\r\n        setTimeout(function() {\r\n          resolve(new Response(body, options))\r\n        }, 0)\r\n\r\n      }\r\n    });\r\n    function abortXhr() {\r\n      requestTask.abort()\r\n    }\r\n    if (request.signal) {\r\n      request.signal.addEventListener('abort', abortXhr)\r\n    }\r\n\r\n  })\r\n}\r\n\r\nfetch.polyfill = true\r\n\r\nif (!global.fetch) {\r\n  global.fetch = fetch\r\n  global.Headers = Headers\r\n  global.Request = Request\r\n  global.Response = Response\r\n}\r\n","var _globalThis;\nif (typeof globalThis === 'object') {\n\t_globalThis = globalThis;\n} else {\n\ttry {\n\t\t_globalThis = require('es5-ext/global');\n\t} catch (error) {\n\t} finally {\n\t\tif (!_globalThis && typeof window !== 'undefined') { _globalThis = window; }\n\t\tif (!_globalThis) { throw new Error('Could not determine global this'); }\n\t}\n}\n\nvar NativeWebSocket = _globalThis.WebSocket || _globalThis.MozWebSocket;\nvar websocket_version = require('./version');\n\n\n/**\n * Expose a W3C WebSocket class with just one or two arguments.\n */\nfunction W3CWebSocket(uri, protocols) {\n\tvar native_instance;\n\n\tif (protocols) {\n\t\tnative_instance = new NativeWebSocket(uri, protocols);\n\t}\n\telse {\n\t\tnative_instance = new NativeWebSocket(uri);\n\t}\n\n\t/**\n\t * 'native_instance' is an instance of nativeWebSocket (the browser's WebSocket\n\t * class). Since it is an Object it will be returned as it is when creating an\n\t * instance of W3CWebSocket via 'new W3CWebSocket()'.\n\t *\n\t * ECMAScript 5: http://bclary.com/2004/11/07/#a-13.2.2\n\t */\n\treturn native_instance;\n}\nif (NativeWebSocket) {\n\t['CONNECTING', 'OPEN', 'CLOSING', 'CLOSED'].forEach(function(prop) {\n\t\tObject.defineProperty(W3CWebSocket, prop, {\n\t\t\tget: function() { return NativeWebSocket[prop]; }\n\t\t});\n\t});\n}\n\n/**\n * Module exports.\n */\nmodule.exports = {\n    'w3cwebsocket' : NativeWebSocket ? W3CWebSocket : null,\n    'version'      : websocket_version\n};\n","var naiveFallback = function () {\n\tif (typeof self === \"object\" && self) return self;\n\tif (typeof window === \"object\" && window) return window;\n\tthrow new Error(\"Unable to resolve global `this`\");\n};\n\nmodule.exports = (function () {\n\tif (this) return this;\n\n\t// Unexpected strict mode (may happen if e.g. bundled into ESM module)\n\n\t// Fallback to standard globalThis if available\n\tif (typeof globalThis === \"object\" && globalThis) return globalThis;\n\n\t// Thanks @mathiasbynens -> https://mathiasbynens.be/notes/globalthis\n\t// In all ES5+ engines global object inherits from Object.prototype\n\t// (if you approached one that doesn't please report)\n\ttry {\n\t\tObject.defineProperty(Object.prototype, \"__global__\", {\n\t\t\tget: function () { return this; },\n\t\t\tconfigurable: true\n\t\t});\n\t} catch (error) {\n\t\t// Unfortunate case of updates to Object.prototype being restricted\n\t\t// via preventExtensions, seal or freeze\n\t\treturn naiveFallback();\n\t}\n\ttry {\n\t\t// Safari case (window.__global__ works, but __global__ does not)\n\t\tif (!__global__) return naiveFallback();\n\t\treturn __global__;\n\t} finally {\n\t\tdelete Object.prototype.__global__;\n\t}\n})();\n","module.exports = require('../package.json').version;\n","\"use strict\";\r\nexports.__esModule = true;\r\nexports.RequestBase = void 0;\r\nvar RequestBase = /** @class */ (function () {\r\n    function RequestBase(appId, clientType, imei) {\r\n        this.appId = appId;\r\n        this.clientType = clientType;\r\n        this.imei = imei;\r\n    }\r\n    return RequestBase;\r\n}());\r\nexports.RequestBase = RequestBase;\r\n","\"use strict\";\r\nexports.__esModule = true;\r\nexports.RequestParams = void 0;\r\nvar RequestParams = /** @class */ (function () {\r\n    function RequestParams(appId, identifier, userSign) {\r\n        this.appId = appId;\r\n        this.identifier = identifier;\r\n        this.userSign = userSign;\r\n    }\r\n    return RequestParams;\r\n}());\r\nexports.RequestParams = RequestParams;\r\n","\"use strict\";\r\nexports.__esModule = true;\r\nvar Logger_1 = require(\"../log/Logger\");\r\nvar ImClient_1 = require(\"./ImClient\");\r\nvar ApiResponse_1 = require(\"../model/ApiResponse\");\r\nvar utils_1 = require(\"../common/utils\");\r\nvar Fetch_1 = require(\"../common/Fetch\");\r\nvar HttpApi = /** @class */ (function () {\r\n    function HttpApi() {\r\n        this.url = \"http://127.0.0.1:8000/v1\"; //http://127.0.0.1:8000/v1\r\n    }\r\n    // constructor(url :string){\r\n    //     this.url = url;\r\n    // }\r\n    HttpApi.prototype.call = function (url, params, body) {\r\n        var userId = ImClient_1.imClient.userId;\r\n        Logger_1[\"default\"].info(userId);\r\n        var reqUrl = this.url + url;\r\n        if (params != null) {\r\n            var paramStr = this.setQueryConfig(params);\r\n            console.log(paramStr);\r\n            reqUrl += paramStr;\r\n        }\r\n        var requestMethod = \"POST\";\r\n        var headers = {\r\n            'Content-Type': 'application/json',\r\n        };\r\n        var request = { method: requestMethod, headers: headers, mode: 'cors', body: utils_1[\"default\"].json(body) };\r\n        return this.httpFetch(reqUrl, request);\r\n    };\r\n    HttpApi.prototype.setQueryConfig = function (params) {\r\n        var _str = \"?\";\r\n        for (var o in params) {\r\n            _str += o + \"=\" + params[o] + \"&\";\r\n        }\r\n        var _str = _str.substring(0, _str.length - 1); //末尾是&\r\n        return _str;\r\n    };\r\n    HttpApi.prototype.httpFetch = function (url, request) {\r\n        var _this = this;\r\n        console.log(\"httpFetch\");\r\n        var rnfetch1 = Fetch_1[\"default\"].getFetchToolkit();\r\n        return rnfetch1(url, request).then(function (response) {\r\n            console.log(response);\r\n            return response.json();\r\n        }).then(function (res) {\r\n            Logger_1[\"default\"].info(\"==> [\" + request.method + \"] \" + url + \" back:\" + utils_1[\"default\"].json(res));\r\n            var resp = _this.response2ApiResponse(res);\r\n            if (resp.isFailed()) {\r\n                return Promise.reject(resp);\r\n            }\r\n            // return Promise.resolve(this.response2ApiResponse(res));\r\n            return Promise.resolve(resp);\r\n        });\r\n    };\r\n    HttpApi.prototype.response2ApiResponse = function (response) {\r\n        var apiResponse = new ApiResponse_1[\"default\"](true);\r\n        apiResponse.data = response.data;\r\n        apiResponse.msg = response.msg;\r\n        apiResponse.code = response.code;\r\n        return apiResponse;\r\n    };\r\n    return HttpApi;\r\n}());\r\nexports[\"default\"] = HttpApi;\r\n// export const httpApi = new HttpApi();\r\n","\"use strict\";\r\nexports.__esModule = true;\r\nvar ApiResponse = /** @class */ (function () {\r\n    function ApiResponse(succeed) {\r\n        if (succeed === void 0) { succeed = false; }\r\n        this.msg = '';\r\n        this.data = null;\r\n        if (succeed) {\r\n            this.code = 200;\r\n        }\r\n    }\r\n    ApiResponse.prototype.isSucceed = function () {\r\n        return this.code === 200;\r\n    };\r\n    ApiResponse.prototype.isFailed = function () {\r\n        return !this.isSucceed();\r\n    };\r\n    return ApiResponse;\r\n}());\r\nexports[\"default\"] = ApiResponse;\r\n","\"use strict\";\r\nexports.__esModule = true;\r\nexports.ConversationEventCommand = exports.UserEventCommand = exports.SystemCommand = exports.GroupCommand = exports.FriendShipCommand = exports.MessageCommand = void 0;\r\nvar MessageCommand;\r\n(function (MessageCommand) {\r\n    MessageCommand[MessageCommand[\"MSG_P2P\"] = 1103] = \"MSG_P2P\";\r\n    MessageCommand[MessageCommand[\"MSG_P2P_SYNC\"] = 1108] = \"MSG_P2P_SYNC\";\r\n    //发送消息已读   1106\r\n    MessageCommand[MessageCommand[\"MSG_READED\"] = 1106] = \"MSG_READED\";\r\n    //消息接收ack\r\n    MessageCommand[MessageCommand[\"MSG_RECIVE_ACK\"] = 1107] = \"MSG_RECIVE_ACK\";\r\n    //单聊消息ACK 1046\r\n    MessageCommand[MessageCommand[\"MSG_ACK\"] = 1046] = \"MSG_ACK\";\r\n    // 消息撤回 1050\r\n    MessageCommand[MessageCommand[\"MSG_RECALL\"] = 1050] = \"MSG_RECALL\";\r\n    // //消息撤回通知 1052\r\n    MessageCommand[MessageCommand[\"MSG_RECALL_NOTIFY\"] = 1052] = \"MSG_RECALL_NOTIFY\";\r\n    // 消息撤回回包 1051\r\n    MessageCommand[MessageCommand[\"MSG_RECALL_ACK\"] = 1051] = \"MSG_RECALL_ACK\";\r\n    // //消息已读通知 1053\r\n    MessageCommand[MessageCommand[\"MSG_READED_NOTIFY\"] = 1053] = \"MSG_READED_NOTIFY\";\r\n})(MessageCommand || (MessageCommand = {}));\r\nexports.MessageCommand = MessageCommand;\r\nvar FriendShipCommand;\r\n(function (FriendShipCommand) {\r\n    //添加好友 3000\r\n    FriendShipCommand[FriendShipCommand[\"FRIEND_ADD\"] = 3000] = \"FRIEND_ADD\";\r\n    //更新好友 3001\r\n    FriendShipCommand[FriendShipCommand[\"FRIEND_UPDATE\"] = 3001] = \"FRIEND_UPDATE\";\r\n    //删除好友 3002\r\n    FriendShipCommand[FriendShipCommand[\"FRIEND_DELETE\"] = 3002] = \"FRIEND_DELETE\";\r\n    //好友申请 3003\r\n    FriendShipCommand[FriendShipCommand[\"FRIEND_REQUEST\"] = 3003] = \"FRIEND_REQUEST\";\r\n    //好友申请已读 3004\r\n    FriendShipCommand[FriendShipCommand[\"FRIEND_REQUEST_READ\"] = 3004] = \"FRIEND_REQUEST_READ\";\r\n    //好友申请审批 3005\r\n    FriendShipCommand[FriendShipCommand[\"FRIEND_REQUEST_APPROVER\"] = 3005] = \"FRIEND_REQUEST_APPROVER\";\r\n    //添加黑名单 3010\r\n    FriendShipCommand[FriendShipCommand[\"FRIEND_BLACK_ADD\"] = 3010] = \"FRIEND_BLACK_ADD\";\r\n    //移除黑名单 3011\r\n    FriendShipCommand[FriendShipCommand[\"FRIEND_BLACK_DELETE\"] = 3011] = \"FRIEND_BLACK_DELETE\";\r\n    //新建好友分组 3012\r\n    FriendShipCommand[FriendShipCommand[\"FRIEND_GROUP_ADD\"] = 3012] = \"FRIEND_GROUP_ADD\";\r\n    //删除好友分组 3013\r\n    FriendShipCommand[FriendShipCommand[\"FRIEND_GROUP_DELETE\"] = 3013] = \"FRIEND_GROUP_DELETE\";\r\n    //好友分组添加成员 3014\r\n    FriendShipCommand[FriendShipCommand[\"FRIEND_GROUP_MEMBER_ADD\"] = 3014] = \"FRIEND_GROUP_MEMBER_ADD\";\r\n    //好友分组移除成员 3015\r\n    FriendShipCommand[FriendShipCommand[\"FRIEND_GROUP_MEMBER_DELETE\"] = 3015] = \"FRIEND_GROUP_MEMBER_DELETE\";\r\n})(FriendShipCommand || (FriendShipCommand = {}));\r\nexports.FriendShipCommand = FriendShipCommand;\r\nvar GroupCommand;\r\n(function (GroupCommand) {\r\n    /**\r\n         * 推送申请入群通知 2000\r\n         */\r\n    GroupCommand[GroupCommand[\"JOIN_GROUP\"] = 2000] = \"JOIN_GROUP\";\r\n    /**\r\n     * 推送添加群成员 2001，通知给所有管理员和本人\r\n     */\r\n    GroupCommand[GroupCommand[\"ADDED_MEMBER\"] = 2001] = \"ADDED_MEMBER\";\r\n    /**\r\n     * 推送创建群组通知 2002，通知给所有人\r\n     */\r\n    GroupCommand[GroupCommand[\"CREATED_GROUP\"] = 2002] = \"CREATED_GROUP\";\r\n    /**\r\n     * 推送更新群组通知 2003，通知给所有人\r\n     */\r\n    GroupCommand[GroupCommand[\"UPDATED_GROUP\"] = 2003] = \"UPDATED_GROUP\";\r\n    /**\r\n     * 推送退出群组通知 2004，通知给管理员和操作人\r\n     */\r\n    GroupCommand[GroupCommand[\"EXIT_GROUP\"] = 2004] = \"EXIT_GROUP\";\r\n    /**\r\n     * 推送修改群成员通知 2005，通知给管理员和被操作人\r\n     */\r\n    GroupCommand[GroupCommand[\"UPDATED_MEMBER\"] = 2005] = \"UPDATED_MEMBER\";\r\n    /**\r\n     * 推送删除群成员通知 2006，通知给所有群成员和被踢人\r\n     */\r\n    GroupCommand[GroupCommand[\"DELETED_MEMBER\"] = 2006] = \"DELETED_MEMBER\";\r\n    /**\r\n     * 推送解散群通知 2007，通知所有人\r\n     */\r\n    GroupCommand[GroupCommand[\"DESTROY_GROUP\"] = 2007] = \"DESTROY_GROUP\";\r\n    /**\r\n     * 推送转让群主 2008，通知所有人\r\n     */\r\n    GroupCommand[GroupCommand[\"TRANSFER_GROUP\"] = 2008] = \"TRANSFER_GROUP\";\r\n    /**\r\n     * 禁言群 2009，通知所有人\r\n     */\r\n    GroupCommand[GroupCommand[\"MUTE_GROUP\"] = 2009] = \"MUTE_GROUP\";\r\n    /**\r\n     * 禁言/解禁 群成员 2010，通知管理员和被操作人\r\n     */\r\n    GroupCommand[GroupCommand[\"SPEAK_GOUP_MEMBER\"] = 2010] = \"SPEAK_GOUP_MEMBER\";\r\n    //群聊消息收发   2104\r\n    GroupCommand[GroupCommand[\"MSG_GROUP\"] = 2104] = \"MSG_GROUP\";\r\n    //群聊消息收发同步消息   2105\r\n    GroupCommand[GroupCommand[\"MSG_GROUP_SYNC\"] = 2105] = \"MSG_GROUP_SYNC\";\r\n    //群聊消息ACK 2047\r\n    GroupCommand[GroupCommand[\"GROUP_MSG_ACK\"] = 2047] = \"GROUP_MSG_ACK\";\r\n})(GroupCommand || (GroupCommand = {}));\r\nexports.GroupCommand = GroupCommand;\r\nvar SystemCommand;\r\n(function (SystemCommand) {\r\n    //心跳 9999\r\n    SystemCommand[SystemCommand[\"PING\"] = 9999] = \"PING\";\r\n    //登陸  9000\r\n    SystemCommand[SystemCommand[\"LOGIN\"] = 9000] = \"LOGIN\";\r\n    //登录ack  9001\r\n    SystemCommand[SystemCommand[\"LOGINACK\"] = 9001] = \"LOGINACK\";\r\n    //下线通知 用于多端互斥  9002\r\n    SystemCommand[SystemCommand[\"MUTUALLOGIN\"] = 9002] = \"MUTUALLOGIN\";\r\n    //登出  9003\r\n    SystemCommand[SystemCommand[\"LOGOUT\"] = 9003] = \"LOGOUT\";\r\n})(SystemCommand || (SystemCommand = {}));\r\nexports.SystemCommand = SystemCommand;\r\nvar UserEventCommand;\r\n(function (UserEventCommand) {\r\n    //4000\r\n    UserEventCommand[UserEventCommand[\"USER_MODIFY\"] = 4000] = \"USER_MODIFY\";\r\n    //4001\r\n    UserEventCommand[UserEventCommand[\"USER_ONLINE_STATUS_CHANGE\"] = 4001] = \"USER_ONLINE_STATUS_CHANGE\";\r\n    //4002 在线状态订阅\r\n    UserEventCommand[UserEventCommand[\"USER_ONLINE_STATUS_SUBSCRIBE\"] = 4002] = \"USER_ONLINE_STATUS_SUBSCRIBE\";\r\n    //4003 拉取订阅的在线状态好友,只发送给请求端\r\n    UserEventCommand[UserEventCommand[\"PULL_USER_ONLINE_STATUS\"] = 4003] = \"PULL_USER_ONLINE_STATUS\";\r\n    //4004 用户在线状态通知报文\r\n    UserEventCommand[UserEventCommand[\"USER_ONLINE_STATUS_CHANGE_NOTIFY\"] = 4004] = \"USER_ONLINE_STATUS_CHANGE_NOTIFY\";\r\n})(UserEventCommand || (UserEventCommand = {}));\r\nexports.UserEventCommand = UserEventCommand;\r\nvar ConversationEventCommand;\r\n(function (ConversationEventCommand) {\r\n    //5000 会话删除\r\n    ConversationEventCommand[ConversationEventCommand[\"CONVERSATION_DELETE\"] = 5000] = \"CONVERSATION_DELETE\";\r\n    //5001 会话修改\r\n    ConversationEventCommand[ConversationEventCommand[\"CONVERSATION_UPDATE\"] = 5001] = \"CONVERSATION_UPDATE\";\r\n})(ConversationEventCommand || (ConversationEventCommand = {}));\r\nexports.ConversationEventCommand = ConversationEventCommand;\r\n","\"use strict\";\r\nexports.__esModule = true;\r\nexports.MessagePack = void 0;\r\nvar utils_1 = require(\"../common/utils\");\r\nvar MessagePack = /** @class */ (function () {\r\n    function MessagePack(appId) {\r\n        this.messageId = utils_1[\"default\"].uuid();\r\n        this.appId = appId;\r\n        this.messageRandom = this.RangeInteger(0, 10000);\r\n        this.messageTime = Date.parse(new Date().toString());\r\n    }\r\n    MessagePack.prototype.RangeInteger = function (min, max) {\r\n        var range = max - min;\r\n        var value = Math.floor(Math.random() * range) + min;\r\n        return value;\r\n    };\r\n    MessagePack.prototype.buildTextMessagePack = function (fromId, toId, text) {\r\n        this.fromId = fromId;\r\n        this.toId = toId;\r\n        var body = { type: 1, content: text };\r\n        this.messageBody = utils_1[\"default\"].json(body);\r\n    };\r\n    MessagePack.prototype.buildCustomerMessagePack = function (fromId, toId, type, obj) {\r\n        this.fromId = fromId;\r\n        this.toId = toId;\r\n        var body = { type: type, content: obj };\r\n        this.messageBody = utils_1[\"default\"].json(body);\r\n    };\r\n    return MessagePack;\r\n}());\r\nexports.MessagePack = MessagePack;\r\n"],"sourceRoot":""}